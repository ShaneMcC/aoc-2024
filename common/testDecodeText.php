#!/usr/bin/php
<?php
   require_once(dirname(__FILE__) . '/common.php');
   require_once(dirname(__FILE__) . '/decodeText.php');

   $tests = [];

// =============================================================================
// All known letters (As of 2021-12-13)
// // =============================================================================
   $tests[] = ['meta' => ['w' => 5, 'h' => 6, 'g' => 0, 'text' => 'A BCDEFGHIJKLOPRSUYZ'],
               'input' => <<<INPUT
 ██       ███   ██  ███  ████ ████  ██  █  █  ███   ██ █  █ █     ██  ███  ███   ███ █  █ █   █████
█  █      █  █ █  █ █  █ █    █    █  █ █  █   █     █ █ █  █    █  █ █  █ █  █ █    █  █ █   █   █
█  █      ███  █    █  █ ███  ███  █    ████   █     █ ██   █    █  █ █  █ █  █ █    █  █  █ █   █
████      █  █ █    █  █ █    █    █ ██ █  █   █     █ █ █  █    █  █ ███  ███   ██  █  █   █   █
█  █      █  █ █  █ █  █ █    █    █  █ █  █   █  █  █ █ █  █    █  █ █    █ █     █ █  █   █  █
█  █      ███   ██  ███  ████ █     ███ █  █  ███  ██  █  █ ████  ██  █    █  █ ███   ██    █  ████
INPUT];

// =============================================================================
// Test different gap sizes.
// =============================================================================
   $tests[] = ['meta' => ['w' => 5, 'h' => 6, 'g' => 0, 'text' => 'EEEE'],
               'input' => <<<INPUT
████ ████ ████ ████
█    █    █    █
███  ███  ███  ███
█    █    █    █
█    █    █    █
████ ████ ████ ████
INPUT];

   $tests[] = ['meta' => ['w' => 5, 'h' => 6, 'g' => 1, 'text' => 'EEEE'],
               'input' => <<<INPUT
████  ████  ████  ████
█     █     █     █
███   ███   ███   ███
█     █     █     █
█     █     █     █
████  ████  ████  ████
INPUT];

   $tests[] = ['meta' => ['w' => 5, 'h' => 6, 'g' => 2, 'text' => 'EEEE'],
               'input' => <<<INPUT
████   ████   ████   ████
█      █      █      █
███    ███    ███    ███
█      █      █      █
█      █      █      █
████   ████   ████   ████
INPUT];

// =============================================================================
// 2021 - Day 13
// =============================================================================
   $tests[] = ['meta' => ['w' => 5, 'h' => 6, 'g' => 0, 'text' => 'EFLFJGRF'],
               'input' => <<<INPUT
████ ████ █    ████   ██  ██  ███  ████
█    █    █    █       █ █  █ █  █ █
███  ███  █    ███     █ █    █  █ ███
█    █    █    █       █ █ ██ ███  █
█    █    █    █    █  █ █  █ █ █  █
████ █    ████ █     ██   ███ █  █ █
INPUT];

   $tests[] = ['meta' => ['w' => 4, 'h' => 6, 'g' => 1, 'text' => 'EFLFJGRF'],
               'input' => <<<INPUT
████ ████ █    ████   ██  ██  ███  ████
█    █    █    █       █ █  █ █  █ █
███  ███  █    ███     █ █    █  █ ███
█    █    █    █       █ █ ██ ███  █
█    █    █    █    █  █ █  █ █ █  █
████ █    ████ █     ██   ███ █  █ █
INPUT];

   $tests[] = ['meta' => ['w' => 5, 'h' => 6, 'g' => 0, 'text' => 'KJBKEUBG'],
               'input' => <<<INPUT
█  █   ██ ███  █  █ ████ █  █ ███   ██
█ █     █ █  █ █ █  █    █  █ █  █ █  █
██      █ ███  ██   ███  █  █ ███  █
█ █     █ █  █ █ █  █    █  █ █  █ █ ██
█ █  █  █ █  █ █ █  █    █  █ █  █ █  █
█  █  ██  ███  █  █ ████  ██  ███   ███
INPUT];

   $tests[] = ['meta' => ['w' => 5, 'h' => 6, 'g' => 0, 'text' => 'HZKHFEJZ'],
               'input' => <<<INPUT
█  █ ████ █  █ █  █ ████ ████   ██ ████
█  █    █ █ █  █  █ █    █       █    █
████   █  ██   ████ ███  ███     █   █
█  █  █   █ █  █  █ █    █       █  █
█  █ █    █ █  █  █ █    █    █  █ █
█  █ ████ █  █ █  █ █    ████  ██  ████
INPUT];

// =============================================================================
// 2019 - Day 11
// =============================================================================
   $tests[] = ['meta' => ['w' => 5, 'h' => 6, 'g' => 0, 'text' => 'ZCGRHKLB'],
               'input' => <<<INPUT
████  ██   ██  ███  █  █ █  █ █    ███
   █ █  █ █  █ █  █ █  █ █ █  █    █  █
  █  █    █    █  █ ████ ██   █    ███
 █   █    █ ██ ███  █  █ █ █  █    █  █
█    █  █ █  █ █ █  █  █ █ █  █    █  █
████  ██   ███ █  █ █  █ █  █ ████ ███
INPUT];

   $tests[] = ['meta' => ['w' => 5, 'h' => 6, 'g' => 0, 'text' => 'APFKRKBR'],
               'input' => <<<INPUT
 ██  ███  ████ █  █ ███  █  █ ███  ███
█  █ █  █ █    █ █  █  █ █ █  █  █ █  █
█  █ █  █ ███  ██   █  █ ██   ███  █  █
████ ███  █    █ █  ███  █ █  █  █ ███
█  █ █    █    █ █  █ █  █ █  █  █ █ █
█  █ █    █    █  █ █  █ █  █ ███  █  █
INPUT];

   $tests[] = ['meta' => ['w' => 5, 'h' => 6, 'g' => 0, 'text' => 'APUGURFH'],
               'input' => <<<INPUT
 ██  ███  █  █  ██  █  █ ███  ████ █  █
█  █ █  █ █  █ █  █ █  █ █  █ █    █  █
█  █ █  █ █  █ █    █  █ █  █ ███  ████
████ ███  █  █ █ ██ █  █ ███  █    █  █
█  █ █    █  █ █  █ █  █ █ █  █    █  █
█  █ █     ██   ███  ██  █  █ █    █  █
INPUT];

   $tests[] = ['meta' => ['w' => 5, 'h' => 6, 'g' => 0, 'text' => 'AHCHZEPK'],
               'input' => <<<INPUT
 ██  █  █  ██  █  █ ████ ████ ███  █  █
█  █ █  █ █  █ █  █    █ █    █  █ █ █
█  █ ████ █    ████   █  ███  █  █ ██
████ █  █ █    █  █  █   █    ███  █ █
█  █ █  █ █  █ █  █ █    █    █    █ █
█  █ █  █  ██  █  █ ████ ████ █    █  █
INPUT];

// =============================================================================
// 2019 - Day 8
// =============================================================================
   $tests[] = ['meta' => ['w' => 5, 'h' => 6, 'g' => 0, 'text' => 'AZCJC'],
               'input' => <<<INPUT
 ██  ████  ██    ██  ██
█  █    █ █  █    █ █  █
█  █   █  █       █ █
████  █   █       █ █
█  █ █    █  █ █  █ █  █
█  █ ████  ██   ██   ██
INPUT];

    $tests[] = ['meta' => ['w' => 5, 'h' => 6, 'g' => 0, 'text' => 'FAHEF'],
               'input' => <<<INPUT
████  ██  █  █ ████ ████
█    █  █ █  █ █    █
███  █  █ ████ ███  ███
█    ████ █  █ █    █
█    █  █ █  █ █    █
█    █  █ █  █ ████ █
INPUT];

    $tests[] = ['meta' => ['w' => 5, 'h' => 6, 'g' => 0, 'text' => 'RKHRY'],
               'input' => <<<INPUT
███  █  █ █  █ ███  █   █
█  █ █ █  █  █ █  █ █   █
█  █ ██   ████ █  █  █ █
███  █ █  █  █ ███    █
█ █  █ █  █  █ █ █    █
█  █ █  █ █  █ █  █   █
INPUT];

    $tests[] = ['meta' => ['w' => 5, 'h' => 6, 'g' => 0, 'text' => 'EJRGP'],
               'input' => <<<INPUT
████   ██ ███   ██  ███
█       █ █  █ █  █ █  █
███     █ █  █ █    █  █
█       █ ███  █ ██ ███
█    █  █ █ █  █  █ █
████  ██  █  █  ███ █
INPUT];

// =============================================================================
// 2016 - Day 8
// =============================================================================
    $tests[] = ['meta' => ['w' => 5, 'h' => 6, 'g' => 0, 'text' => 'UPOJFLBCEZ'],
               'input' => <<<INPUT
█  █ ███   ██    ██ ████ █    ███   ██  ████ ████
█  █ █  █ █  █    █ █    █    █  █ █  █ █       █
█  █ █  █ █  █    █ ███  █    ███  █    ███    █
█  █ ███  █  █    █ █    █    █  █ █    █     █
█  █ █    █  █ █  █ █    █    █  █ █  █ █    █
 ██  █     ██   ██  █    ████ ███   ██  ████ ████
INPUT];

    $tests[] = ['meta' => ['w' => 5, 'h' => 6, 'g' => 0, 'text' => 'AFBUPZBJPS'],
               'input' => <<<INPUT
 ██  ████ ███  █  █ ███  ████ ███    ██ ███   ███
█  █ █    █  █ █  █ █  █    █ █  █    █ █  █ █
█  █ ███  ███  █  █ █  █   █  ███     █ █  █ █
████ █    █  █ █  █ ███   █   █  █    █ ███   ██
█  █ █    █  █ █  █ █    █    █  █ █  █ █       █
█  █ █    ███   ██  █    ████ ███   ██  █    ███
INPUT];

    $tests[] = ['meta' => ['w' => 5, 'h' => 6, 'g' => 0, 'text' => 'EFEYKFRFIJ'],
               'input' => <<<INPUT
████ ████ ████ █   ██  █ ████ ███  ████  ███   ██
█    █    █    █   ██ █  █    █  █ █      █     █
███  ███  ███   █ █ ██   ███  █  █ ███    █     █
█    █    █      █  █ █  █    ███  █      █     █
█    █    █      █  █ █  █    █ █  █      █  █  █
████ █    ████   █  █  █ █    █  █ █     ███  ██
INPUT];


// =============================================================================
// Characters from:
// https://www.reddit.com/r/adventofcode/comments/5h571u/2016_day_8_generate_an_input/day4ctx/
// =============================================================================
    $tests[] = ['meta' => ['w' => 5, 'h' => 6, 'g' => 0, 'text' => 'ADVENT OF CODE'],
               'input' => <<<INPUT
 ██  ███  █   █████ █   ██████      ██  ████       ██   ██  ███  ████
█  █ █  █ █   ██    ██  █  █       █  █ █         █  █ █  █ █  █ █
█  █ █  █ █   ████  █ █ █  █       █  █ ███       █    █  █ █  █ ███
████ █  █  █ █ █    █ █ █  █       █  █ █         █    █  █ █  █ █
█  █ █  █  █ █ █    █  ██  █       █  █ █         █  █ █  █ █  █ █
█  █ ███    █  ████ █   █  █        ██  █          ██   ██  ███  ████
INPUT];

// =============================================================================
// Characters from:
// https://www.reddit.com/r/adventofcode/comments/5h9sfd/2016_day_8_tampering_detected/
// =============================================================================
    $tests[] = ['meta' => ['w' => 5, 'h' => 6, 'g' => 0, 'text' => 'CDNERYVHKP'],
               'input' => <<<INPUT
 ██  ███  █  █ ████ ███  █   ██   ██  █ █  █ ███
█  █ █  █ █  █ █    █  █ █   ██   ██  █ █ █  █  █
█    █  █ ██ █ ███  █  █  █ █ █   █████ ██   █  █
█    █  █ █ ██ █    ███    █   █ █ █  █ █ █  ███
█  █ █  █ █  █ █    █ █    █   █ █ █  █ █ █  █
 ██  ███  █  █ ████ █  █   █    █  █  █ █  █ █
INPUT];

    $tests[] = ['meta' => ['w' => 5, 'h' => 6, 'g' => 0, 'text' => 'YOU GOT IT'],
               'input' => <<<INPUT
█   █ ██  █  █       ██   ██  █████      ███ █████
█   ██  █ █  █      █  █ █  █   █         █    █
 █ █ █  █ █  █      █    █  █   █         █    █
  █  █  █ █  █      █ ██ █  █   █         █    █
  █  █  █ █  █      █  █ █  █   █         █    █
  █   ██   ██        ███  ██    █        ███   █
INPUT];




   foreach ($tests as $test) {
      $map = [];
      foreach (explode("\n", $test['input']) as $row) { $map[] = mb_str_split($row); }
      if (isDebug()) {
         drawSparseMap($map, ' ', true);
      }
      $decoded = decodeText($map, $test['meta']['w'], $test['meta']['h'], $test['meta']['g']);
      echo 'Decoded: ', json_encode($test['meta']), ' as ', $decoded, ' => ', ($decoded == $test['meta']['text'] ? "\033[0;32mSuccess.\033[0m" : "\033[1;31mFail.\033[0m"), "\n";
      if (isDebug()) {
         echo "\n";
      }
   }
